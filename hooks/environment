#!/usr/bin/env bash

set -euo pipefail

if [[ -n ${BUILDKITE_PLUGIN_MODIFY_CHECKOUT_PATH_PATTERN+x} ]]; then
  echo "--- Changing BUILDKITE_BUILD_CHECKOUT_PATH using ${BUILDKITE_PLUGIN_MODIFY_CHECKOUT_PATH_PATTERN}"
  export BUILDKITE_BUILD_CHECKOUT_PATH=$(echo "$BUILDKITE_BUILD_CHECKOUT_PATH" | sed $BUILDKITE_PLUGIN_MODIFY_CHECKOUT_PATH_PATTERN)
  echo "--- Changed BUILDKITE_BUILD_CHECKOUT_PATH to $BUILDKITE_BUILD_CHECKOUT_PATH"
fi
